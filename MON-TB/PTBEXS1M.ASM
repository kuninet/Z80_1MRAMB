; Small-C Version 3.01  90/06/01  < FUTURE FORUM & S.Kiyo > 
; modify for 128kRAM (KZ80-1MSRAM)
; 
ITOP	EQU	0100H
FTOP	EQU	4000H
LTOP	EQU	5000H
VTOP	EQU	07000H
STACK	EQU	07E00H
;
LBUF	EQU	VTOP+0037H
LBFSZ	EQU	80
MSTK	EQU	LBUF+LBFSZ
TMSTK	EQU	MSTK+30
;
PROMPT	EQU	'>'
RUBOUT	EQU	7FH
BS	EQU	08H
ESC	EQU	1BH
;
TST	MACRO	STR,ADRS
	CALL	TEST
	DB	STR
	DB	ADRS-$-1
	ENDM
CASE	MACRO	STR,ADRS
	DB	STR
	DB	(ADRS SHR 8)+80H
	DB	ADRS AND 0FFH
	ENDM
ENDC	MACRO	ADRS
	DB	(ADRS+8000H) SHR 8
	DB	ADRS AND 0FFH
	ENDM
;
UARTRD	EQU	00H
UARTRC	EQU	01H
;
;	BDOS VERSION 1.03
;
;
;	RESET
	ORG	0000H
	JMP	SYSINI
;
;	BDOS
	ORG	0005H
BDOS:
	PUSH	PSW
	MOV	A,C
	RLC
	ADD	C
	MOV	C,A
	POP	PSW
	MVI	B,00H
	LXI	H,JMPTBL
	DAD	B
	PCHL
JMPTBL:	JMP	SYSINI
	JMP	RBUFRD
	JMP	USRTWT
	JMP	RBUFRD
	JMP	USRTWT
	JMP	USRTWT
	JMP	DCONIO
;
;	8251 -> A
USRTRD:
	IN	UARTRC
	ANI	00000010B
	JZ	USRTRD
	IN	UARTRD
	RET
;
;	RST7
	ORG	0038H
INTRCV:
	DI
	PUSH	PSW
	PUSH	B
	PUSH	D
	PUSH	H
	CALL	USRTRD
	CPI	11H
	JZ	STRWT1
	CPI	13H
	JNZ	STRWT2
STRWT1:	STA	XFLAGS
	JMP	RWTEXT
STRWT2:	MOV	D,A
	LDA	RBFCNT
	CPI	0FFH
	JZ	RWTEXT
	CPI	0FFH-80
	JNZ	STRWT3
	MVI	E,13H
	CALL	USRTWT
STRWT3:	INR	A
	STA	RBFCNT
	LDA	RBFWTP
	MOV	C,A
	MVI	B,00H
	LXI	H,RECBUF
	DAD	B
	MOV	M,D
	INR	A
	STA	RBFWTP
RWTEXT:	POP	H
	POP	D
	POP	B
	POP	PSW
	EI
	RET
;
;	BUFER -> A
RBUFRD:
	PUSH	B
	PUSH	D
	PUSH	H
LOPRBR:	LDA	RBFCNT
	CPI	00H
	JZ	LOPRBR
	DI
	CPI	0FFH-80
	JNZ	STRRD1
	MVI	E,11H
	CALL	USRTWT
STRRD1:	DCR	A
	STA	RBFCNT
	LDA	RBFRDP
	MOV	C,A
	MVI	B,00H
	LXI	H,RECBUF
	DAD	B
	MOV	D,M
	INR	A
	STA	RBFRDP
	MOV	A,D
	EI
	POP	H
	POP	D
	POP	B
	RET
;
;	E -> 8251
USRTWT:
	PUSH	PSW
UWLOP1:	LDA	XFLAGS
	CPI	13H
	JZ	UWLOP1
UWLOP2:	IN	UARTRC
	ANI	00000001B
	JZ	UWLOP2
	MOV	A,E
	OUT	UARTRD
	POP	PSW
	RET
;
;	DIRECT I/O
DCONIO:
	PUSH	PSW
	MOV	A,E
	CPI	0FFH
	JZ	DCONIN
	JMP	UWLOP2
DCONIN:	POP	PSW
	LDA	RBFCNT
	CPI	00H
	RZ
	JMP	RBUFRD
;
;	SYSTEM INITIALIZE
SYSINI:
	LXI	SP,STACK
;	DB	0EDH,056H
	MVI	A,11H
	STA	XFLAGS
	MVI	A,00H
	STA	RBFCNT
	STA	RBFRDP
	STA	RBFWTP
	OUT	UARTRC
	OUT	UARTRC
	OUT	UARTRC
	MVI	A,01000000B
	OUT	UARTRC
	MVI	A,01001110B
	OUT	UARTRC
	MVI	A,00110111B
	OUT	UARTRC
;
	EI
;
	JMP	ENTRY
;
	ORG	ITOP
ENTRY:
;-- BANK MEM SET
	MVI	A,01H
	OUT	80H
;
	LXI	SP,STACK
	LXI	H,OTOP
	SHLD	OBTM
	CALL	CRLF
	LXI	D,OPNMS1
	SUB	A
	CALL	MSG
	LXI	D,OPNMS2
	SUB	A
	CALL	MSG
	LXI	D,OPNMS3
	SUB	A
	CALL	MSG
;
START:
	CALL	CRLF
	LXI	D,OKMES
	SUB	A
	CALL	MSG
	LXI	H,$+7
	SHLD	CLABL
	LXI	H,0000H
	SHLD	FCNTR
	SHLD	RSTCK
;
EDITR:	MVI	A,PROMPT
	CALL	GETL
	PUSH	D
	LXI	D,LBUF
	CALL	GINT
	CALL	SKPBL
	MOV	A,H
	ORA	L
	POP	B
	JZ	KWCPR
INSRT:	DCX	D
	MOV	A,H
	STAX	D
	DCX	D
	MOV	A,L
	STAX	D
	PUSH	B
	PUSH	D
	MOV	A,C
	SUB	E
	PUSH	PSW
	CALL	SRCH
	PUSH	D
	JNZ	MOVE
	PUSH	D
	CALL	SKIPL
	POP	B
	LHLD	OBTM
	CALL	TRNSF
	MOV	H,B
	MOV	L,C
	SHLD	OBTM
MOVE:	POP	B
	LHLD	OBTM
	POP	PSW
	PUSH	H
	CPI	03H
	JZ	START
	ADD	L
	MOV	L,A
	MVI	A,00H
	ADC	H
	MOV	H,A
	LXI	D,VTOP
	CALL	COMPR
	JNC	ERSRY
	SHLD	OBTM
	POP	D
	CALL	TR2
	POP	D
	POP	H
	CALL	TRNSF
	JMP	EDITR
;
GETL:	CALL	PUT
	LXI	D,LBUF
GETL1:	CALL	GET
	JZ	GETL1
	CPI	0AH
	JZ	GETL1
	ORA	A
	JZ	GETL1
	CPI	BS
	JZ	CRUB
	CPI	'X'-'@'
	JZ	CCAN
	CALL	PUT
	STAX	D
	INX	D
	CPI	0DH
	RZ
	MOV	A,E
	CPI	LBUFL + LBFSZ
	JNZ	GETL1
CRUB:	MOV	A,E
	CPI	LBUFL
	JZ	GETL1
	DCX	D
	MVI	A,BS
	CALL	PUT
	JMP	GETL1
CCAN:	CALL	CRLF
	MVI	A,'@'
	JMP	GETL
LBUFL	EQU	LBUF AND 0FFH
;
SRCH:	MOV	A,H
	ORA	A
	JM	ERHOW
	LXI	D,OTOP
SRCH1:	PUSH	H
	LHLD	OBTM
	DCX	H
	CALL	COMPR
	POP	H
	RC
	LDAX	D
	SUB	L
	MOV	B,A
	INX	D
	LDAX	D
	SBB	H
	JC	SKPL1
	DCX	D
	ORA	B
	RET
;
SKIPL:	INX	D
SKPL1:	INX	D
SKPL2:	LDAX	D
	CPI	0DH
	JNZ	SKPL1
	INX	D
	JMP	SRCH1
;
TRNSF:	CALL	COMPR
	RZ
	LDAX	D
	STAX	B
	INX	D
	INX	B
	JMP	TRNSF
;
TR2:	MOV	A,B
	SUB	D
	JNZ	TR2E
	MOV	A,C
	SUB	E
	RZ
TR2E:	DCX	D
	DCX	H
	LDAX	D
	MOV	M,A
	JMP	TR2
;
KWCPR:	LXI	H,CMDKW-1
;
NXTKW:	CALL	SKPBL
NXTK1:	PUSH	D
KWC1:	LDAX	D
	INX	D
	CPI	'.'
	JZ	KWSRT
	INX	H
	CMP	M
	JZ	KWC1
	MVI	A,7FH
	DCX	D
	CMP	M
	JC	EXEQT
KWSK1:	INX	H
	CMP	M
	JNC	KWSK1
	INX	H
	POP	D
	JMP	NXTK1
;
KWSRT:	MVI	A,7FH
KWSK2:	INX	H
	CMP	M
	JNC	KWSK2
;
EXEQT:	MOV	A,M
	INX	H
	MOV	L,M
	ANI	7FH
	MOV	H,A
	POP	PSW
	PCHL
;
TEST:	XTHL
	CALL	SKPBL
	CMP	M
	INX	H
	JZ	TSTEQ
	PUSH	B
	MOV	C,M
	MVI	B,00H
	DAD	B
	POP	B
	DCX	D
TSTEQ:	INX	D
	INX	H
	XTHL
	RET
;
SKPBL:	LDAX	D
	CPI	' '
	RNZ
	INX	D
	JMP	SKPBL
;
CMDKW:	CASE	'LIST',LIST
	CASE	'RUN',RUN
	CASE	'NEW',NEW
	CASE	'SYSTEM',SSYSTEM
	CASE	'MON',MON
STMKW:	CASE	'NEXT',NEXT
	CASE	'LET',LET
	CASE	'INPUT',INPUT
	CASE	'IF',IFSTM
	CASE	'GOTO',GOTO
	CASE	'GOSUB',GOSUB
	CASE	'RETURN',RETRN
	CASE	'REM',REM
	CASE	'FOR',FOR
	CASE	'PRINT',PRINT
	CASE	'STOP',STOP
	CASE	'EXEC',SEXEC
	ENDC	LETDF
;
MON:	JMP	main
;
SEXEC:
	CALL	EEXPR
	PUSH	PSW
	PUSH	B
	PUSH	D
	LXI	D,EXRET
	PUSH	D
	LXI	D,FTOP
	DAD	D
	PCHL
EXRET:	POP	D
	POP	B
	POP	PSW
	JMP	ENDL
;
NEW:	CALL	TSCR2
	LXI	H,OTOP
	SHLD	OBTM
STOP:	CALL	TSCR2
	JMP	START
SSYSTEM:
	MVI	C,0
	CALL	0005H
;
GOSUB:	CALL	PSHV
	CALL	EEXPR
	PUSH	D
	CALL	SRCH
	JNZ	ERHW1
	LHLD	CLABL
	PUSH	H
	LHLD	RSTCK
	PUSH	H
	LXI	H,0000H
	SHLD	FCNTR
	DAD	SP
	SHLD	RSTCK
	JMP	RUN2
;
RETRN:	CALL	TSCR2
	LHLD	RSTCK
	MOV	A,H
	ORA	L
	JZ	ERWHT
	SPHL
	POP	H
	SHLD	RSTCK
	POP	H
	SHLD	CLABL
	POP	D
	CALL	POPV
	JMP	ENDL
;
FOR:	CALL	PSHV
	CALL	LTSUB
	DCX	H
	SHLD	FCNTR
	LXI	H,KWTO-1
	JMP	NXTKW
KWTO:	CASE	'TO',FORTO
	ENDC	ERWHT
;
FORTO:	CALL	EEXPR
	SHLD	FTOV
	LXI	H,KWSTP-1
	JMP	NXTKW
KWSTP:	CASE	'STEP',FSTEP
	ENDC	FSTP1
;
FSTEP:	CALL	EEXPR
	JMP	FOR0
FSTP1:	LXI	H,0001H
FOR0:	SHLD	FSTPV
	LHLD	CLABL
	SHLD	FLABL
	XCHG
	SHLD	FOBJ
	LXI	B,000AH
	LHLD	FCNTR
	XCHG
	MOV	H,B
	MOV	L,B
	DAD	SP
	DB	3EH
FOR3:	DAD	B
	MOV	A,M
	INX	H
	ORA	M
	JZ	FOR10
	MOV	A,M
	DCX	H
	CMP	D
	JNZ	FOR3
	MOV	A,M
	CMP	E
	JNZ	FOR3
FOR5:	XCHG
	LXI	H,0000H
	DAD	SP
	MOV	B,H
	MOV	C,L
	LXI	H,000AH
	DAD	D
	CALL	TR2
	SPHL
FOR10:	LHLD	FOBJ
	XCHG
	JMP	ENDL
;
NEXT:	CALL	TSTV
	JC	ERWHT
	SHLD	NCNTR
NEXT1:	PUSH	D
	XCHG
	LHLD	FCNTR
	MOV	A,H
	ORA	L
	JZ	ERWT1
	CALL	COMPR
	JZ	NEXT2
	POP	D
	CALL	POPV
	LHLD	NCNTR
	JMP	NEXT1
NEXT2:	MOV	E,M
	INX	H
	MOV	D,M
	LHLD	FSTPV
	PUSH	H
	DAD	D
	XCHG
	LHLD	FCNTR
	MOV	M,E
	INX	H
	MOV	M,D
	LHLD	FTOV
	POP	PSW
	ORA	A
	JP	NEXT4
	XCHG
NEXT4:	CALL	CMINT
	POP	D
	JC	NEXT5
	LHLD	FLABL
	SHLD	CLABL
	LHLD	FOBJ
	XCHG
	JMP	ENDL
NEXT5:	CALL	POPV
	JMP	ENDL
;
PSHV:	LXI	H,TMSTK
	CALL	TWSCP
	POP	B
	DAD	SP
	JNC	ERSRY
	LHLD	FCNTR
	MOV	A,H
	ORA	L
	JZ	NPSH
	LHLD	FOBJ
	PUSH	H
	LHLD	FLABL
	PUSH	H
	LHLD	FTOV
	PUSH	H
	LHLD	FSTPV
	PUSH	H
	LHLD	FCNTR
NPSH:	PUSH	H
	PUSH	B
	RET
;
POPV:	POP	B
	POP	H
	SHLD	FCNTR
	MOV	A,H 
	ORA	L
	JZ	NPOP
	POP	H
	SHLD	FSTPV
	POP	H
	SHLD	FTOV
	POP	H
	SHLD	FLABL
	POP	H
	SHLD	FOBJ
NPOP:	PUSH	B
	RET
;
IFSTM:	CALL	EEXPR
	MOV	A,H
	ORA	L
	JNZ	NXTGO
REM:	LXI	H,0000H
	CALL	SKPL2
	JNC	RUN2
	JMP	START
;
LIST:	CALL	GINT
	CALL	TSCR2
	CALL	SRCH
LISTL:	JC	START
	CALL	WLINE
	CALL	BREAK
	CALL	SRCH1
	JMP	LISTL
;
WLINE:	LDAX	D
	MOV	L,A
	INX	D
	LDAX	D
	MOV	H,A
	INX	D
	MVI	C,04H
	CALL	WINT
	MVI	A,' '
	CALL	PUT
	SUB	A
	CALL	MSG
	RET
;
PRINT:	MVI	C,6
PRSC:	TST	';',PRCR
	CALL	CRLF
	JMP	NXTGO
PRCR:	TST	0DH,PRSHA
	CALL	CRLF
	JMP	RUN1
PRSHA:	TST	'#',PRLTR
	CALL	EEXPR
	MOV	C,L
	JMP	PRCMA
PRLTR:	CALL	PRSUB
	JMP	PREXP
PRCMA:	TST	',',PREND
	CALL	TSTSC
	JMP	PRSHA
PREND:	CALL	CRLF
	JMP	ENDL
PREXP:	CALL	EEXPR
	PUSH	B
	CALL	WINT
	POP	B
	JMP	PRCMA
;
PRSUB:	TST	'"',PR13
	MVI	A,'"'
	JMP	PR11
PR13:	TST	'''''',PR14
	MVI	A,''''
PR11:	CALL	MSG
	CPI	0DH
	POP	H
	JZ	RUN1
	JMP	PR12
PR14:	TST	'_',PR15
	MVI	A,80H+0DH
	CALL	PUT
	CALL	PUT
	POP	H
PR12:	INX	H
	INX	H
	INX	H
	PCHL
PR15:	RET
;
WINT:	PUSH	D
	LXI	D,000AH
	PUSH	D
	MOV	B,D
	DCR	C
	CALL	ABS
	JP	WINT1
	MVI	B,'-'
	DCR	C
WINT1:	PUSH	B
WINT2:	CALL	DIVID
	MOV	A,B
	ORA	C
	JZ	WINT3
	XTHL
	DCR	L
	PUSH	H
	MOV	H,B
	MOV	L,C
	JMP	WINT2
WINT3:	POP	B
WINT4:	DCR	C
	MOV	A,C
	ORA	A
	JM	WINT5
	MVI	A,' '
	CALL	PUT
	JMP	WINT4
WINT5:	MOV	A,B
	CALL	PUT
	MOV	E,L
WINT6:	MOV	A,E
	CPI	0AH
	POP	D
	RZ
	ADI	30H
	CALL	PUT
	JMP	WINT6
;
ERRIN:	LHLD	NCNTR
	SPHL
	POP	H
	SHLD	CLABL
	POP	D
	POP	D
INPUT:	PUSH	D
	CALL	PRSUB
	JMP	INPT2
INPT1:	CALL	TSTV
	JC	INPT6
	JMP	INPT4
INPT2:	PUSH	D
	CALL	TSTV
	JC	ERWHT
	LDAX	D
	MOV	C,A
	SUB	A
	STAX	D
	POP	D
	CALL	MSG
	MOV	A,C
	DCX	D
	STAX	D
INPT4:	PUSH	D
	XCHG
	LHLD	CLABL
	PUSH	H
	LXI	H,INPUT
	SHLD	CLABL
	LXI	H,0000H
	DAD	SP
	SHLD	NCNTR
	PUSH	D
	MVI	A,':'
	CALL	GETL
	LXI	D,LBUF
	CALL	EEXPR
	POP	D
	XCHG
	MOV	M,E
	INX	H
	MOV	M,D
	POP	H
	SHLD	CLABL
	POP	D
INPT6:	POP	PSW
	TST	',',ENDL
	JMP	INPUT
;
LETDF:	CALL	TSCR1
	CPI	0DH
	JZ	ENDL
LET:	CALL	LTSUB
	TST	',',ENDL
	JMP	LET
;
LTSUB:	CALL	TSTV
	JC	ERWHT
	PUSH	H
	TST	'=',LERR
	CALL	EEXPR
	MOV	B,H
	MOV	C,L
	POP	H
	MOV	M,C
	INX	H
	MOV	M,B
	RET
;
GOTO:	CALL	EEXPR
	PUSH	D
	CALL	TSCR2
	CALL	SRCH
	JNZ	ERHW1
	POP	PSW
	JMP	RUN2
;
RUN:	CALL	TSCR2
	LXI	D,OTOP
RUN1:	LXI	H,0000H
	CALL	SRCH1
	JC	START
RUN2:	XCHG
	SHLD	CLABL
	XCHG
	INX	D
	INX	D
NXTGO:	CALL	BREAK
	LXI	H,STMKW-1
	JMP	NXTKW
;
ENDL:	CALL	TSTSC
LERR:	JMP	ERWHT
;
TSTSC:	TST	';',TSCR1
	POP	PSW
	JMP	NXTGO
;
TSCR1:	TST	0DH,TSRTN
	POP	PSW
	JMP	RUN1
TSRTN:	RET
;
TSCR2:	CALL	SKPBL
	CPI	0DH
	RZ
	JMP	ERWHT
;
EEXPR:	CALL	EXPR
	PUSH	H
	LXI	H,ROPKW-1
	JMP	NXTKW
ROPKW:	CASE	'>=',GE1
	CASE	'<>',NE1
	CASE	'>',GT1
	CASE	'=',EQ1
	CASE	'<=',LE1
	CASE	'<',LT1
	ENDC	NOROP
;
GE1:	CALL	IFEXQ
	RC
	MOV	L,A
	RET
;
NE1:	CALL	IFEXQ
	RZ
	MOV	L,A
	RET
;
GT1:	CALL	IFEXQ
	RZ
	RC
	MOV	L,A
	RET
LE1:	CALL	IFEXQ
	MOV	L,A
	RZ
	RC
	MOV	L,H
	RET
EQ1:	CALL	IFEXQ
	RNZ
	MOV	L,A
	RET
LT1:	CALL	IFEXQ
	RNC
	MOV	L,A
	RET
NOROP:	POP	H
	RET
;
IFEXQ:	MOV	A,C
	POP	H
	POP	B
	PUSH	H
	PUSH	B
	MOV	C,A
	CALL	EXPR
	XCHG
	XTHL
	CALL	CMINT
	POP	D
	LXI	H,0000H
	MVI	A,01H
	RET
;
EXPR:	TST	'-',EXPR1
	LXI	H,0000H
	JMP	NEGA1
EXPR1:	TST	'+',EXPR3
EXPR3:	CALL	TERM
EXPR2:	TST	'+',NEGA0
	PUSH	H
	CALL	TERM
	JMP	ADDBL
NEGA0:	TST	'-',EXPRT
NEGA1:	PUSH	H
	CALL	TERM
	CALL	TWSCP
ADDBL:	XCHG
	XTHL
	MOV	A,H
	XRA	D
	MOV	A,D
	DAD	D
	POP	D
	JM	EXPR2
	XRA	H
	JP	EXPR2
	JMP	ERHOW
;
TERM:	CALL	FACTR
SMULT:	TST	'*',SDIV
	PUSH	H
	CALL	FACTR
	MVI	B,00H
	CALL	ABS
	XCHG
	XTHL
	CALL	ABS
	MOV	A,H
	ORA	A
	JZ	MULT1
	MOV	A,D
	ORA	D
	XCHG
	JNZ	ERHW1
MULT1:	MOV	A,L
	MVI	L,0
	ORA	A
	JZ	TERM1
MULTL:	DAD	D
	JC	ERHW1
	DCR	A
	JNZ	MULTL
	JMP	TERM1
SDIV:	TST	'/',EXPRT
	PUSH	H
	CALL	FACTR
	MVI	B,00H
	CALL	ABS
	XCHG
	XTHL
	CALL	ABS
	MOV	A,D
	ORA	E
	JZ	ERHW1
	PUSH	B
	CALL	DIVID
	MOV	H,B
	MOV	L,C
	POP	B
TERM1:	POP	D
	MOV	A,H
	ORA	A
	JM	ERHOW
	MOV	A,B
	ORA	A
	CM	TWSCP
	JMP	SMULT
;
DIVID:	PUSH	H
	MOV	L,H
	MVI	H,00H
	CALL	DIVSB
	MOV	B,C
	MOV	A,L
	POP	H
	MOV	H,A
DIVSB:	MVI	C,0FFH
DIVS1:	INR	C
	CALL	DIFF
	JNC	DIVS1
	DAD	D
EXPRT:	RET
;
DIFF:	MOV	A,L
	SUB	E
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A
	RET
;
ABS:	MOV	A,H
	ORA	A
	RP
TWSCP:	MOV	A,H
	CMA
	MOV	H,A
	MOV	A,L
	CMA
	MOV	L,A
	INX	H
	MOV	A,B
	XRI	80H
	MOV	B,A
	RET
;
CMINT:	MOV	A,H
	XRA	D
	JP	COMPR
	XCHG
COMPR:	MOV	A,H
	CMP	D
	RNZ
	MOV	A,L
	CMP	E
	RET
;
FACTR:	LXI	H,FNKW-1
	JMP	NXTKW
FNKW:	CASE	'RND',RND
	CASE	'ABS',FNABS
	CASE	'SIZE',RSIZE
	ENDC	VAR
;
RND:	CALL	EXPR0
	MOV	A,H
	ORA	A
	JM	ERHOW
	ORA	L
	JZ	ERHOW
	PUSH	D
	PUSH	H
	LHLD	RWRK
;;	INX	H
	MOV	A,H
	ANI	07H
	MOV	H,A
;;	DCR	L
	LXI	D,ITOP	;
	DAD	D	;
RND1:	MOV	E,M
	INX	H
	MOV	D,M
	SHLD	RWRK
	POP	H
	XCHG
	PUSH	B
	CALL	DIVID
	POP	B
	POP	D
	INX	H
	RET
;
FNABS:	CALL	EXPR0
	CALL	ABS
	MOV	A,H
	ORA	H
	JM	ERHOW
	RET
;
RSIZE:	LHLD	OBTM
	PUSH	D
	XCHG
	LXI	H,VTOP
	CALL	DIFF
	POP	D
	RET
;
VAR:	CALL	TSTV
	JC	NUMB
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	RET
;
TSTV:	CALL	SKPBL
	SUI	'@'
	RC
	JNZ	TSTV1
	INX	D
	CALL	EXPR0
	DAD	H
	JC	ERHOW
	PUSH	D
	XCHG
	CALL	RSIZE
	CALL	COMPR
	JC	ERSY1
	LXI	H,VTOP
	CALL	DIFF
	POP	D
	RET
TSTV1:	CPI	'Z'+1-'@'
	CMC
	RC
	INX	D
	LXI	H,VTOP
	RLC
	ADD	L
	MOV	L,A
	MVI	A,00H
	ADC	H
	MOV	H,A
	RET
;
GINT:	LXI	H,0000H
	MOV	B,H
	CALL	SKPBL
GETI1:	CPI	'0'
	RC
	CPI	'9'+1
	RNC
	MVI	A,0F0H
	ANA	H
	JNZ	ERHOW
	INR	B
	PUSH	B
	MOV	B,H
	MOV	C,L
	DAD	H
	DAD	H
	DAD	B
	DAD	H
	LDAX	D
	INX	D
	ANI	0FH
	ADD	L
	MOV	L,A
	MVI	A,00H
	ADC	H
	MOV	H,A
	POP	B
	LDAX	D
	JM	ERHOW
	JMP	GETI1
;
NUMB:	CALL	GINT
	MOV	A,B
	ORA	A
	RNZ
;
EXPR0:	TST	'(',ERWHT
	CALL	EEXPR
	TST	')',ERWHT
	RET
;
ERWHT:	PUSH	D
ERWT1:	LXI	D,WHTMS
	JMP	LERMS
ERHOW:	PUSH	D
ERHW1:	LXI	D,HOWMS
	JMP	LERMS
ERSRY:	PUSH	D
ERSY1:	LXI	D,SRYMS
LERMS:	SUB	A
	CALL	MSG
	POP	D
	LDAX	D
	PUSH	PSW
	SUB	A
	STAX	D
	LHLD	CLABL
	PUSH	H
	MOV	A,M
	INX	H
	ORA	M
	POP	D
	JZ	START
	MOV	A,M
	ORA	A
	JM	ERRIN
	CALL	WLINE
	DCX	D
	POP	PSW
	STAX	D
	MVI	A,'?'
	CALL	PUT
	SUB	A
	CALL	MSG
	JMP	START
;
OKMES:	DB	'OK'
	DB	0DH
HOWMS:	DB	'HOW?'
	DB	0DH
WHTMS:	DB	'WHAT?'
	DB	0DH
SRYMS:	DB	'SORRY'
	DB	0DH
;
OPNMS1:	DB	'PALO ALTO '
	DB	'TINY BASIC'
	DB	0DH
OPNMS2:	DB	'MON80 EXTENDED'
	DB	0DH
OPNMS3:	DB	'SBC8080 EDITION'
	DB	0DH
;
MSG:	MOV	B,A
MSG1:	LDAX	D
	INX	D
	CMP	B
	RZ
	CALL	PUT
	CPI	0DH
	JNZ	MSG1
	RET
;
CRLF:	MVI	A,0DH
PUT:	PUSH	PSW
	PUSH	B
	PUSH	D
	PUSH	H
	MVI	C,02H
	ANI	07FH
	MOV	E,A
	CALL	0005H
	POP	H
	POP	D
	POP	B	
	POP	PSW
;
	CPI	0DH
	RNZ
	MVI	A,0AH
	CALL	PUT
	MVI	A,0DH
	RET
;
BREAK	EQU	$
GET:
	PUSH	B
	PUSH	D
	PUSH	H
	MVI	C,06H
	MVI	E,0FFH
	CALL	0005H
	POP	H
	POP	D
	POP	B
	ANI	7FH
	RZ
	CPI	ESC
	JNZ	GET1
	INX	SP
	INX	SP
	JMP	START
;
GET1:	CPI	'a'
	RC
	CPI	'z'+1
	RNC
	ANI	11011111B
	RET
CC1:
main:
	LXI	H,-484
	DAD	SP
	SPHL
	LXI	H,482
	DAD	SP
	XCHG;;
	LXI	H,16384
	CALL	CCPINT
	LXI	H,400
	DAD	SP
	PUSH	H
	LXI	H,322
	DAD	SP
	PUSH	H
	LXI	H,244
	DAD	SP
	PUSH	H
	LXI	H,166
	DAD	SP
	PUSH	H
	LXI	H,88
	DAD	SP
	PUSH	H
	LXI	H,10
	DAD	SP
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	POP	D
	MOV	A,L
	STAX	D
	POP	D
	MOV	A,L
	STAX	D
	POP	D
	MOV	A,L
	STAX	D
	POP	D
	MOV	A,L
	STAX	D
	POP	D
	MOV	A,L
	STAX	D
CC3:
	LXI	H,482
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	asmpmt
	POP	B
	LXI	H,400
	DAD	SP
	PUSH	H
	LXI	H,73
	PUSH	H
	MVI	A,2
	CALL	getstr
	POP	B
	POP	B
	LXI	H,400
	DAD	SP
	PUSH	H
	LXI	H,322
	DAD	SP
	PUSH	H
	LXI	H,164
	DAD	SP
	PUSH	H
	MVI	A,3
	CALL	setcmd
	POP	B
	POP	B
	POP	B
	LXI	H,160
	DAD	SP
	PUSH	H
	LXI	H,82
	DAD	SP
	PUSH	H
	LXI	H,4
	DAD	SP
	PUSH	H
	MVI	A,3
	CALL	setpar
	POP	B
	POP	B
	POP	B
	LXI	H,400
	DAD	SP
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC5
	LXI	H,240
	DAD	SP
	PUSH	H
	LXI	H,322
	DAD	SP
	PUSH	H
	MVI	A,2
	CALL	strcpy
	POP	B
	POP	B
CC5:
	LXI	H,240
	DAD	SP
	PUSH	H
	LXI	H,CC2+0
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC6
	LXI	H,80
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC7
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,82
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
CC7:
	LXI	H,0
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC8
	LXI	H,480
	DAD	SP
	PUSH	H
	LXI	H,2
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC9
CC8:
	LXI	H,480
	DAD	SP
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	LXI	D,16
	DAD	D
	POP	D
	CALL	CCPINT
CC9:
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,2
	CALL	discod
	POP	B
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC10
CC6:
	LXI	H,240
	DAD	SP
	PUSH	H
	LXI	H,CC2+5
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC11
	LXI	H,80
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC12
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,82
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
CC12:
	LXI	H,0
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC13
	LXI	H,480
	DAD	SP
	PUSH	H
	LXI	H,2
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC14
CC13:
	LXI	H,480
	DAD	SP
	XCHG;;
	LXI	H,482
	DAD	SP
	CALL	CCGINT
	CALL	CCPINT
CC14:
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,2
	CALL	dmpcod
	POP	B
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC15
CC11:
	LXI	H,320
	DAD	SP
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JNZ	CC16
	JMP	CC17
CC16:
	LXI	H,320
	DAD	SP
	PUSH	H
	LXI	H,CC2+10
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC18
	XRA	A
	CALL	system
	JMP	CC19
CC18:
	LXI	H,320
	DAD	SP
	PUSH	H
	LXI	H,CC2+17
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC20
	LXI	H,160
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	dsphlp
	POP	B
	JMP	CC21
CC20:
	LXI	H,320
	DAD	SP
	PUSH	H
	LXI	H,CC2+22
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC22
	LXI	H,80
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC23
	LXI	H,80
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	PUSH	H
	MVI	A,1
	CALL	exec
	POP	B
	JMP	CC24
CC23:
	LXI	H,CC2+27
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,80
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
CC24:
	JMP	CC25
CC22:
	LXI	H,320
	DAD	SP
	PUSH	H
	LXI	H,CC2+34
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC26
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,164
	DAD	SP
	PUSH	H
	MVI	A,2
	CALL	define
	POP	B
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC27
CC26:
	LXI	H,320
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC28
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,322
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
	JMP	CC29
CC28:
	LXI	H,482
	DAD	SP
	PUSH	H
	LXI	H,484
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,324
	DAD	SP
	PUSH	H
	LXI	H,86
	DAD	SP
	PUSH	H
	LXI	H,8
	DAD	SP
	PUSH	H
	MVI	A,4
	CALL	asmlin
	XCHG;;
	LXI	H,8
	DAD	SP
	SPHL
	XCHG;;
	POP	D
	CALL	CCPINT
CC29:
CC27:
CC25:
CC21:
CC19:
CC17:
CC15:
CC10:
	JMP	CC3
CC4:
	LXI	H,484
	DAD	SP
	SPHL
	RET
CC2:	DB	76,73,83,84,0,68,85,77,80,0
	DB	83,89,83,84,69,77,0,72,69,76
	DB	80,0,69,88,69,67,0,69,82,82
	DB	79,82,45,0,68,69,70,73,78,69
	DB	0
discod:
CC33:
	LXI	H,4
	DAD	SP
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	dislin
	POP	B
	POP	D
	CALL	CCPINT
CC31:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCULE
	MOV	A,H
	ORA	L
	JZ	CC32
	JMP	CC33
CC32:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	RET
dislin:
	DCX	SP
	PUSH	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putwrd
	POP	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,2
	DAD	SP
	PUSH	H
	LXI	H,7
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	opecod
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	CALL	CCPINT
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC35
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putbyt
	POP	B
	LXI	H,5
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,1
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC36
CC35:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC37
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	POP	H
	PUSH	H
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putwrd
	POP	B
	LXI	H,5
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,2
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC38
CC37:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	MOV	A,H
	ORA	L
	JZ	CC39
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	JMP	CC40
CC39:
	XRA	A
	CALL	putnwl
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	INX	SP
	POP	B
	RET
CC40:
CC38:
CC36:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	CALL	CCPINT
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC41
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putbyt
	POP	B
	LXI	H,5
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,1
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC42
CC41:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC43
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	POP	H
	PUSH	H
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putwrd
	POP	B
	LXI	H,5
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,2
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC44
CC43:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	MOV	A,H
	ORA	L
	JZ	CC45
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
CC45:
CC44:
CC42:
	XRA	A
	CALL	putnwl
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	INX	SP
	POP	B
	RET
dmpcod:
	LXI	H,CC46+0
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,CC46+7
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,CC46+56
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,4
	DAD	SP
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,-16
	CALL	CCAND
	POP	D
	CALL	CCPINT
CC49:
	LXI	H,4
	DAD	SP
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	dmplin
	POP	B
	POP	D
	CALL	CCPINT
CC47:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCSUB
	XCHG;;
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCULT
	MOV	A,H
	ORA	L
	JZ	CC48
	JMP	CC49
CC48:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	RET
CC46:	DB	32,32,32,32,32,32,0,43,48,32
	DB	43,49,32,43,50,32,43,51,32,43
	DB	52,32,43,53,32,43,54,32,43,55
	DB	32,43,56,32,43,57,32,43,65,32
	DB	43,66,32,43,67,32,43,68,32,43
	DB	69,32,43,70,32,0,65,83,67,73
	DB	73,0
dmplin:
	LXI	H,-18
	DAD	SP
	SPHL
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,20
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putwrd
	POP	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC53:
	POP	D
	PUSH	D
	LXI	H,16
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC52
	JMP	CC54
CC51:
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC53
CC54:
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	PUSH	H
	LXI	H,22
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC51
CC52:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC57:
	POP	D
	PUSH	D
	LXI	H,16
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC56
	JMP	CC58
CC55:
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC57
CC58:
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putbyt
	POP	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	JMP	CC55
CC56:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC61:
	POP	D
	PUSH	D
	LXI	H,16
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC60
	JMP	CC62
CC59:
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC61
CC62:
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isprint
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC63
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	JMP	CC64
CC63:
	LXI	H,46
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
CC64:
	JMP	CC59
CC60:
	XRA	A
	CALL	putnwl
	LXI	H,20
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,18
	DAD	SP
	SPHL
	XCHG;;
	RET
define:
	LXI	H,-82
	DAD	SP
	SPHL
CC66:
	LXI	H,84
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC67
	LXI	H,84
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,4
	DAD	SP
	PUSH	H
	LXI	H,88
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,3
	CALL	setpar
	POP	B
	POP	B
	POP	B
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,2
	DAD	SP
	CALL	CCPINT
	POP	H
	PUSH	H
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC68
	LXI	H,86
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	xtob
	POP	B
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC69
CC68:
	POP	H
	PUSH	H
	CALL	CCGCHAR
	XCHG;;
	LXI	H,39
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC70
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
CC71:
	POP	H
	PUSH	H
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC73
	POP	H
	PUSH	H
	CALL	CCGCHAR
	XCHG;;
	LXI	H,39
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC73
	LXI	H,1
	JMP	CC74
CC73:
	LXI	H,0
CC74:
	MOV	A,H
	ORA	L
	JZ	CC72
	LXI	H,86
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC71
CC72:
	JMP	CC75
CC70:
	LXI	H,CC65+0
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,2
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	JMP	CC67
CC75:
CC69:
	JMP	CC66
CC67:
	LXI	H,86
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,82
	DAD	SP
	SPHL
	XCHG;;
	RET
CC65:	DB	69,114,114,111,114,45,0
dsphlp:
	PUSH	B
	PUSH	B
	PUSH	B
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JNZ	CC77
	LXI	H,CC76+0
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+38
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+62
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+89
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+116
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+144
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+175
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	LXI	H,CC76+203
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
	JMP	CC78
CC77:
CC79:
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC81
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isspace
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC82
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC82
	LXI	H,0
	JMP	CC83
CC82:
	LXI	H,1
CC83:
	MOV	A,H
	ORA	L
	JZ	CC81
	LXI	H,1
	JMP	CC84
CC81:
	LXI	H,0
CC84:
	MOV	A,H
	ORA	L
	JZ	CC80
	LXI	H,8
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC79
CC80:
	LXI	H,4
	DAD	SP
	XCHG;;
	LXI	H,08
	DAD	SP
	CALL	CCGINT
	CALL	CCPINT
CC85:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC87
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isspace
	POP	B
	CALL	CCLNEG
	MOV	A,H
	ORA	L
	JZ	CC87
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC87
	LXI	H,1
	JMP	CC88
CC87:
	LXI	H,0
CC88:
	MOV	A,H
	ORA	L
	JZ	CC86
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC85
CC86:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
	LXI	H,2
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC91:
	POP	B
	POP	D
	PUSH	D
	PUSH	B
	LXI	H,255
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC90
	JMP	CC92
CC89:
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC91
CC92:
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	opecod
	POP	B
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC93
	LXI	H,CC76+235
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	opecod
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC94
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,CC76+242
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	JMP	CC95
CC94:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC96
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,CC76+245
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	JMP	CC97
CC96:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	MOV	A,H
	ORA	L
	JZ	CC98
	LXI	H,9
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
CC98:
CC97:
CC95:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC99
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,CC76+250
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	JMP	CC100
CC99:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC101
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,CC76+253
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	JMP	CC102
CC101:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	MOV	A,H
	ORA	L
	JZ	CC103
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
CC103:
CC102:
CC100:
	XRA	A
	CALL	putnwl
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,1
	CALL	CCPINT
CC93:
	JMP	CC89
CC90:
	POP	H
	PUSH	H
	MOV	A,H
	ORA	L
	JNZ	CC104
	LXI	H,CC76+258
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,8
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	XRA	A
	CALL	putnwl
CC104:
CC78:
	POP	B
	POP	B
	POP	B
	RET
CC76:	DB	32,32,32,32,32,32,120,120,120,120
	DB	32,32,32,32,32,67,104,97,110,103
	DB	101,32,99,117,114,114,101,110,116,32
	DB	97,100,100,114,101,115,115,0,32,32
	DB	32,32,32,32,109,110,101,109,111,110
	DB	105,99,32,65,115,115,101,109,98,108
	DB	101,0,32,32,32,32,32,32,76,73
	DB	83,84,32,32,32,32,32,68,105,115
	DB	97,115,115,101,109,98,108,101,0,32
	DB	32,32,32,32,32,68,69,70,73,78
	DB	69,32,32,32,68,101,102,105,110,101
	DB	32,100,97,116,97,0,32,32,32,32
	DB	32,32,68,85,77,80,32,32,32,32
	DB	32,68,105,115,112,108,97,121,32,100
	DB	97,116,97,0,32,32,32,32,32,32
	DB	69,88,69,67,32,32,32,32,32,69
	DB	120,101,99,117,116,101,32,112,114,111
	DB	103,114,97,109,0,32,32,32,32,32
	DB	32,72,69,76,80,32,32,32,32,32
	DB	68,105,115,112,108,97,121,32,104,101
	DB	108,112,0,32,32,32,32,32,32,83
	DB	89,83,84,69,77,32,32,32,82,101
	DB	116,117,114,110,32,116,111,32,115,121
	DB	115,116,101,109,0,32,32,32,32,32
	DB	32,0,120,120,0,120,120,120,120,0
	DB	120,120,0,120,120,120,120,0,69,82
	DB	82,79,82,45,0
asmlin:
	DCX	SP
	PUSH	B
	PUSH	B
	LXI	H,4
	DAD	SP
	XCHG;;
	LXI	H,255
	MOV	A,L
	STAX	D
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC106:
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGCHAR
	DCX	H
	MOV	A,L
	STAX	D
	INX	H
	MOV	A,H
	ORA	L
	JZ	CC108
	POP	D
	PUSH	D
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC108
	LXI	H,1
	JMP	CC109
CC108:
	LXI	H,0
CC109:
	MOV	A,H
	ORA	L
	JZ	CC107
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	opecod
	POP	B
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC110
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC112
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC113
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC113
	LXI	H,1
	JMP	CC114
CC113:
	LXI	H,0
CC114:
	MOV	A,H
	ORA	L
	JNZ	CC112
	LXI	H,0
	JMP	CC115
CC112:
	LXI	H,1
CC115:
	MOV	A,H
	ORA	L
	JZ	CC111
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,6
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC117
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	isxstr
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC118
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC118
	LXI	H,1
	JMP	CC119
CC118:
	LXI	H,0
CC119:
	MOV	A,H
	ORA	L
	JNZ	CC117
	LXI	H,0
	JMP	CC120
CC117:
	LXI	H,1
CC120:
	MOV	A,H
	ORA	L
	JZ	CC116
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,1
	CALL	CCPINT
CC116:
CC111:
CC110:
	JMP	CC106
CC107:
	POP	H
	PUSH	H
	MOV	A,H
	ORA	L
	JNZ	CC121
	LXI	H,CC105+0
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC122
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
CC122:
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC123
	LXI	H,44
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
CC123:
	XRA	A
	CALL	putnwl
	LXI	H,13
	DAD	SP
	CALL	CCGINT
	INX	SP
	POP	B
	POP	B
	RET
CC121:
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGCHAR
	INX	H
	MOV	A,L
	STAX	D
	DCX	H
	LXI	H,13
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	XCHG;;
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	MOV	A,L
	STAX	D
	LXI	H,2
	DAD	SP
	XCHG;;
	LXI	H,13
	DAD	SP
	CALL	CCGINT
	CALL	CCPINT
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC124
	LXI	H,13
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	xtob
	POP	B
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,13
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,1
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC125
CC124:
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,1
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC126
	LXI	H,13
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	xtob
	POP	B
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,13
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,1
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC127
CC126:
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd1
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC128
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
	LXI	H,13
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,2
	DAD	D
	POP	D
	CALL	CCPINT
	JMP	CC129
CC128:
	LXI	H,4
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	operd2
	POP	B
	CALL	CCGINT
	XCHG;;
	LXI	H,2
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC130
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,9
	DAD	SP
	CALL	CCGINT
	PUSH	H
	MVI	A,1
	CALL	xtoi
	POP	B
	POP	D
	CALL	CCPINT
	LXI	H,13
	DAD	SP
	PUSH	H
	CALL	CCGINT
	LXI	D,2
	DAD	D
	POP	D
	CALL	CCPINT
CC130:
CC129:
CC127:
CC125:
	LXI	H,13
	DAD	SP
	CALL	CCGINT
	INX	SP
	POP	B
	POP	B
	RET
CC105:	DB	69,82,82,79,82,45,0
asmpmt:
	LXI	H,91
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	MVI	A,1
	CALL	putwrd
	POP	B
	LXI	H,93
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	RET
setcmd:
CC133:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC135
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isspace
	POP	B
	MOV	A,H
	ORA	L
	JNZ	CC136
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC136
	LXI	H,0
	JMP	CC137
CC136:
	LXI	H,1
CC137:
	MOV	A,H
	ORA	L
	JZ	CC135
	LXI	H,1
	JMP	CC138
CC135:
	LXI	H,0
CC138:
	MOV	A,H
	ORA	L
	JZ	CC134
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC133
CC134:
CC139:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC141
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isspace
	POP	B
	CALL	CCLNEG
	MOV	A,H
	ORA	L
	JZ	CC141
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC141
	LXI	H,1
	JMP	CC142
CC141:
	LXI	H,0
CC142:
	MOV	A,H
	ORA	L
	JZ	CC140
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,8
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC139
CC140:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
CC143:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC145
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC145
	LXI	H,1
	JMP	CC146
CC145:
	LXI	H,0
CC146:
	MOV	A,H
	ORA	L
	JZ	CC144
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC143
CC144:
CC147:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC148
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,8
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC147
CC148:
	POP	B
	POP	D
	PUSH	D
	PUSH	B
	LXI	H,0
	MOV	A,L
	STAX	D
	RET
setpar:
CC150:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC152
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC152
	LXI	H,1
	JMP	CC153
CC152:
	LXI	H,0
CC153:
	MOV	A,H
	ORA	L
	JZ	CC151
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC150
CC151:
CC154:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC156
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC156
	LXI	H,1
	JMP	CC157
CC156:
	LXI	H,0
CC157:
	MOV	A,H
	ORA	L
	JZ	CC155
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,8
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC154
CC155:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC159
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,44
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC159
	LXI	H,1
	JMP	CC160
CC159:
	LXI	H,0
CC160:
	MOV	A,H
	ORA	L
	JZ	CC158
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
CC158:
CC161:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC163
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC163
	LXI	H,1
	JMP	CC164
CC163:
	LXI	H,0
CC164:
	MOV	A,H
	ORA	L
	JZ	CC162
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC161
CC162:
CC165:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC166
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,8
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC165
CC166:
	POP	B
	POP	D
	PUSH	D
	PUSH	B
	LXI	H,0
	MOV	A,L
	STAX	D
	RET
isprint:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC168
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,126
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC168
	LXI	H,1
	JMP	CC169
CC168:
	LXI	H,0
CC169:
	RET
isspace:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC171
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,32
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC172
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,13
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC173
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,9
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC173
	LXI	H,1
	JMP	CC174
CC173:
	LXI	H,0
CC174:
	MOV	A,H
	ORA	L
	JNZ	CC172
	LXI	H,0
	JMP	CC175
CC172:
	LXI	H,1
CC175:
	MOV	A,H
	ORA	L
	JZ	CC171
	LXI	H,1
	JMP	CC176
CC171:
	LXI	H,0
CC176:
	RET
isxdigit:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,102
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC178
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,97
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC178
	LXI	H,1
	JMP	CC179
CC178:
	LXI	H,0
CC179:
	MOV	A,H
	ORA	L
	JNZ	CC180
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,70
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC181
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,65
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC181
	LXI	H,1
	JMP	CC182
CC181:
	LXI	H,0
CC182:
	MOV	A,H
	ORA	L
	JNZ	CC180
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,57
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC183
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,48
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC183
	LXI	H,1
	JMP	CC184
CC183:
	LXI	H,0
CC184:
	MOV	A,H
	ORA	L
	JNZ	CC180
	LXI	H,0
	JMP	CC185
CC180:
	LXI	H,1
CC185:
	RET
isxstr:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC188
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,CC186+0
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC188
	LXI	H,0
	JMP	CC189
CC188:
	LXI	H,1
CC189:
	MOV	A,H
	ORA	L
	JZ	CC187
	LXI	H,0
	RET
CC187:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,CC186+4
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC191
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,CC186+8
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC191
	LXI	H,0
	JMP	CC192
CC191:
	LXI	H,1
CC192:
	MOV	A,H
	ORA	L
	JZ	CC190
	LXI	H,0
	RET
CC190:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,CC186+11
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC194
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	PUSH	H
	LXI	H,CC186+15
	PUSH	H
	MVI	A,2
	CALL	strcmp
	POP	B
	POP	B
	XCHG;;
	LXI	H,0
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC194
	LXI	H,0
	JMP	CC195
CC194:
	LXI	H,1
CC195:
	MOV	A,H
	ORA	L
	JZ	CC193
	LXI	H,0
	RET
CC193:
CC196:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isxdigit
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC197
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC196
CC197:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JNZ	CC198
	LXI	H,1
	RET
CC198:
	LXI	H,0
	RET
CC199:
	RET
CC186:	DB	65,68,67,0,65,68,68,0,67,67
	DB	0,68,65,65,0,68,65,68,0
strcpy:
CC201:
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	PUSH	H
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	MOV	A,H
	ORA	L
	JZ	CC202
	JMP	CC201
CC202:
	RET
strcmp:
CC204:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC205
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JNZ	CC206
	LXI	H,0
	RET
CC206:
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	JMP	CC204
CC205:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	CALL	CCSUB
	RET
itoa:
	LXI	H,-13
	DAD	SP
	SPHL
	LXI	H,11
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC210:
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,8
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC209
	JMP	CC211
CC208:
	LXI	H,11
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC210
CC211:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	DAD	D
	XCHG;;
	LXI	H,32
	MOV	A,L
	STAX	D
	JMP	CC208
CC209:
	LXI	H,8
	DAD	SP
	PUSH	H
	LXI	H,19
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,0
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC212
	LXI	H,43
	JMP	CC213
CC212:
	LXI	H,45
CC213:
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,11
	DAD	SP
	XCHG;;
	LXI	H,7
	CALL	CCPINT
CC216:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	DAD	D
	PUSH	H
	LXI	H,19
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,10
	CALL	CCDIV
	XCHG;;
	LXI	D,48
	DAD	D
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,17
	DAD	SP
	PUSH	H
	LXI	H,19
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,10
	CALL	CCDIV
	POP	D
	CALL	CCPINT
	LXI	H,11
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	DCX	H
	CALL	CCPINT
	INX	H
CC214:
	LXI	H,17
	DAD	SP
	CALL	CCGINT
	XRA	A
	ORA	H
	JM	CC215
	ORA	L
	JZ	CC215
	JMP	CC216
CC215:
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	DAD	D
	XCHG;;
	LXI	H,08
	DAD	SP
	CALL	CCGCHAR
	MOV	A,L
	STAX	D
	LXI	H,9
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC217:
	LXI	H,11
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,8
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC218
	LXI	H,15
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,11
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	POP	D
	DAD	D
	PUSH	H
	LXI	H,2
	DAD	SP
	PUSH	H
	LXI	H,15
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	POP	D
	DAD	D
	CALL	CCGCHAR
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC217
CC218:
	LXI	H,15
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,09
	DAD	SP
	CALL	CCGINT
	DAD	D
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	LXI	H,13
	DAD	SP
	SPHL
	RET
atoi:
	PUSH	B
	PUSH	B
	LXI	H,0
	DAD	SP
	PUSH	H
	LXI	H,4
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
	POP	D
	CALL	CCPINT
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,43
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC221
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,45
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JNZ	CC221
	LXI	H,0
	JMP	CC222
CC221:
	LXI	H,1
CC222:
	MOV	A,H
	ORA	L
	JZ	CC220
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	XCHG;;
	LXI	H,45
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC223
	LXI	H,0
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	CALL	CCNEG
	CALL	CCPINT
CC223:
CC220:
CC224:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC225
	LXI	H,2
	DAD	SP
	PUSH	H
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	LXI	D,10
	CALL	CCMULT
	PUSH	H
	LXI	H,10
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	POP	D
	DAD	D
	XCHG;;
	LXI	H,48
	CALL	CCSUB
	POP	D
	CALL	CCPINT
	JMP	CC224
CC225:
	POP	H
	PUSH	H
	MOV	A,H
	ORA	L
	JZ	CC226
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCNEG
	POP	B
	POP	B
	RET
CC226:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	POP	B
	POP	B
	RET
xtob:
	PUSH	B
	LXI	H,1
	DAD	SP
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
CC228:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC229
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,48
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC231
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,57
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC231
	LXI	H,1
	JMP	CC232
CC231:
	LXI	H,0
CC232:
	MOV	A,H
	ORA	L
	JZ	CC230
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,48
	MOV	A,L
	STAX	D
	JMP	CC233
CC230:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,65
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC235
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,70
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC235
	LXI	H,1
	JMP	CC236
CC235:
	LXI	H,0
CC236:
	MOV	A,H
	ORA	L
	JZ	CC234
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,55
	MOV	A,L
	STAX	D
	JMP	CC237
CC234:
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,97
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC239
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,102
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC239
	LXI	H,1
	JMP	CC240
CC239:
	LXI	H,0
CC240:
	MOV	A,H
	ORA	L
	JZ	CC238
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,87
	MOV	A,L
	STAX	D
	JMP	CC241
CC238:
	JMP	CC229
CC241:
CC237:
CC233:
	LXI	H,1
	DAD	SP
	PUSH	H
	LXI	H,3
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,4
	CALL	CCASL
	XCHG;;
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	DAD	D
	XCHG;;
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	CALL	CCSUB
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,4
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC228
CC229:
	LXI	H,1
	DAD	SP
	CALL	CCGCHAR
	POP	B
	RET
xtoi:
	PUSH	B
	PUSH	B
	LXI	H,2
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC243:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC244
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,48
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC246
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,57
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC246
	LXI	H,1
	JMP	CC247
CC246:
	LXI	H,0
CC247:
	MOV	A,H
	ORA	L
	JZ	CC245
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,48
	CALL	CCPINT
	JMP	CC248
CC245:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,65
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC250
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,70
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC250
	LXI	H,1
	JMP	CC251
CC250:
	LXI	H,0
CC251:
	MOV	A,H
	ORA	L
	JZ	CC249
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,55
	CALL	CCPINT
	JMP	CC252
CC249:
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,97
	CALL	CCGE
	MOV	A,H
	ORA	L
	JZ	CC254
	LXI	H,6
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	XCHG;;
	LXI	H,102
	CALL	CCLE
	MOV	A,H
	ORA	L
	JZ	CC254
	LXI	H,1
	JMP	CC255
CC254:
	LXI	H,0
CC255:
	MOV	A,H
	ORA	L
	JZ	CC253
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,87
	CALL	CCPINT
	JMP	CC256
CC253:
	JMP	CC244
CC256:
CC252:
CC248:
	LXI	H,2
	DAD	SP
	PUSH	H
	LXI	H,4
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,4
	CALL	CCASL
	XCHG;;
	LXI	H,08
	DAD	SP
	CALL	CCGINT
	CALL	CCGCHAR
	DAD	D
	XCHG;;
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCSUB
	POP	D
	CALL	CCPINT
	LXI	H,6
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	JMP	CC243
CC244:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	POP	B
	POP	B
	RET
putnwl:
	LXI	H,CC257+0
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	RET
CC257:	DB	13,10,0
putwrd:
	LXI	H,-8
	DAD	SP
	SPHL
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,3
	CALL	CCPINT
CC261:
	POP	H
	PUSH	H
	XRA	A
	ORA	H
	JM	CC260
	JMP	CC262
CC259:
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	DCX	H
	CALL	CCPINT
	INX	H
	JMP	CC261
CC262:
	LXI	H,7
	DAD	SP
	PUSH	H
	LXI	H,12
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,15
	CALL	CCAND
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,10
	DAD	SP
	PUSH	H
	LXI	H,12
	DAD	SP
	CALL	CCGINT
	XCHG;;
	LXI	H,4
	CALL	CCASR
	XCHG;;
	LXI	H,4095
	CALL	CCAND
	POP	D
	CALL	CCPINT
	LXI	H,7
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,10
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC263
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	PUSH	H
	LXI	H,9
	DAD	SP
	CALL	CCGCHAR
	LXI	D,48
	DAD	D
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC264
CC263:
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	PUSH	H
	LXI	H,9
	DAD	SP
	CALL	CCGCHAR
	LXI	D,55
	DAD	D
	POP	D
	MOV	A,L
	STAX	D
CC264:
	JMP	CC259
CC260:
	LXI	H,2
	DAD	SP
	LXI	D,4
	DAD	D
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	LXI	H,2
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	LXI	H,8
	DAD	SP
	SPHL
	RET
putbyt:
	PUSH	B
	PUSH	B
	PUSH	B
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,1
	CALL	CCPINT
CC268:
	POP	H
	PUSH	H
	XRA	A
	ORA	H
	JM	CC267
	JMP	CC269
CC266:
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	DCX	H
	CALL	CCPINT
	INX	H
	JMP	CC268
CC269:
	LXI	H,5
	DAD	SP
	PUSH	H
	LXI	H,10
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,15
	CALL	CCAND
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,8
	DAD	SP
	PUSH	H
	LXI	H,10
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,4
	CALL	CCASR
	XCHG;;
	LXI	H,4095
	CALL	CCAND
	POP	D
	MOV	A,L
	STAX	D
	LXI	H,5
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,10
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC270
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	PUSH	H
	LXI	H,7
	DAD	SP
	CALL	CCGCHAR
	LXI	D,48
	DAD	D
	POP	D
	MOV	A,L
	STAX	D
	JMP	CC271
CC270:
	LXI	H,2
	DAD	SP
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	PUSH	H
	LXI	H,7
	DAD	SP
	CALL	CCGCHAR
	LXI	D,55
	DAD	D
	POP	D
	MOV	A,L
	STAX	D
CC271:
	JMP	CC266
CC267:
	LXI	H,2
	DAD	SP
	LXI	D,2
	DAD	D
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	LXI	H,2
	DAD	SP
	PUSH	H
	MVI	A,1
	CALL	putstr
	POP	B
	POP	B
	POP	B
	POP	B
	RET
putstr:
CC273:
	POP	B
	POP	H
	PUSH	H
	PUSH	B
	CALL	CCGCHAR
	MOV	A,H
	ORA	L
	JZ	CC274
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	JMP	CC273
CC274:
	RET
getstr:
	DCX	SP
	PUSH	B
	LXI	H,0
	DAD	SP
	XCHG;;
	LXI	H,0
	CALL	CCPINT
CC276:
	LXI	H,2
	DAD	SP
	PUSH	H
	XRA	A
	CALL	getchr
	POP	D
	MOV	A,L
	STAX	D
	XCHG;;
	LXI	H,13
	CALL	CCNE
	MOV	A,H
	ORA	L
	JZ	CC277
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,9
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC278
	LXI	H,2
	DAD	SP
	XCHG;;
	LXI	H,32
	MOV	A,L
	STAX	D
CC278:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	XCHG;;
	LXI	H,8
	CALL	CCEQ
	MOV	A,H
	ORA	L
	JZ	CC280
	POP	D
	PUSH	D
	LXI	H,0
	CALL	CCGT
	MOV	A,H
	ORA	L
	JZ	CC280
	LXI	H,1
	JMP	CC281
CC280:
	LXI	H,0
CC281:
	MOV	A,H
	ORA	L
	JZ	CC279
	LXI	H,0
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	DCX	H
	CALL	CCPINT
	INX	H
	LXI	H,8
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,32
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	LXI	H,8
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
	JMP	CC282
CC279:
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	isprint
	POP	B
	MOV	A,H
	ORA	L
	JZ	CC284
	POP	D
	PUSH	D
	LXI	H,5
	DAD	SP
	CALL	CCGINT
	CALL	CCLT
	MOV	A,H
	ORA	L
	JZ	CC284
	LXI	H,1
	JMP	CC285
CC284:
	LXI	H,0
CC285:
	MOV	A,H
	ORA	L
	JZ	CC283
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	PUSH	H
	LXI	H,2
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
	CALL	CCPINT
	DCX	H
	POP	D
	DAD	D
	XCHG;;
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	MOV	A,L
	STAX	D
	LXI	H,2
	DAD	SP
	CALL	CCGCHAR
	PUSH	H
	MVI	A,1
	CALL	putchr
	POP	B
CC283:
CC282:
	JMP	CC276
CC277:
	LXI	H,7
	DAD	SP
	CALL	CCGINT
	XCHG;;
	POP	H
	PUSH	H
	DAD	D
	XCHG;;
	LXI	H,0
	MOV	A,L
	STAX	D
	XRA	A
	CALL	putnwl
	INX	SP
	POP	B
	RET
exec:
	POP	B
	POP	D
	PUSH	D
	PUSH	B
	LXI	H,ADRRET
	PUSH	H
	XCHG
	PCHL
ADRRET:
	RET
putchr:
	POP	B
	POP	D
	PUSH	D
	PUSH	B
	MVI	C,02H
	CALL	0005H
	RET
getchr:
GCLOOP:
	MVI	C,06H
	MVI	E,0FFH
	CALL	0005H
	CPI	00H
	JZ	GCLOOP
	CPI	'a'
	JC	GCRET
	CPI	'z'+1
	JNC	GCRET
	ANI	11011111B
GCRET:	MVI	H,00H
	MOV	L,A
	RET
system:
	POP	H
	JMP	START
	RET
OPC001:	DB	'?',00H
OPC002:	DB	'A','C','I',00H
OPC003:	DB	'A','D','C',00H
OPC004:	DB	'A','D','D',00H
OPC005:	DB	'A','D','I',00H
OPC006:	DB	'A','N','A',00H
OPC007:	DB	'A','N','I',00H
OPC008:	DB	'C','A','L','L',00H
OPC009:	DB	'C','C',00H
OPC010:	DB	'C','M',00H
OPC011:	DB	'C','M','A',00H
OPC012:	DB	'C','M','C',00H
OPC013:	DB	'C','M','P',00H
OPC014:	DB	'C','N','Z',00H
OPC015:	DB	'C','P',00H
OPC016:	DB	'C','P','E',00H
OPC017:	DB	'C','P','I',00H
OPC018:	DB	'C','P','O',00H
OPC019:	DB	'C','Z',00H
OPC020:	DB	'D','A','A',00H
OPC021:	DB	'D','A','D',00H
OPC022:	DB	'D','C','R',00H
OPC023:	DB	'D','C','X',00H
OPC024:	DB	'D','I',00H
OPC025:	DB	'E','I',00H
OPC026:	DB	'H','L','T',00H
OPC027:	DB	'I','N',00H
OPC028:	DB	'I','N','R',00H
OPC029:	DB	'I','N','X',00H
OPC030:	DB	'J','C',00H
OPC031:	DB	'J','C','Z',00H
OPC032:	DB	'J','M',00H
OPC033:	DB	'J','M','P',00H
OPC034:	DB	'J','N','Z',00H
OPC035:	DB	'J','P',00H
OPC036:	DB	'J','P','E',00H
OPC037:	DB	'J','P','O',00H
OPC038:	DB	'J','Z',00H
OPC039:	DB	'L','D','A',00H
OPC040:	DB	'L','D','A','X',00H
OPC041:	DB	'L','H','L','D',00H
OPC042:	DB	'L','X','I',00H
OPC043:	DB	'M','O','V',00H
OPC044:	DB	'M','V','I',00H
OPC045:	DB	'N','O','P',00H
OPC046:	DB	'O','R','A',00H
OPC047:	DB	'O','R','I',00H
OPC048:	DB	'O','U','T',00H
OPC049:	DB	'P','C','H','L',00H
OPC050:	DB	'P','O','P',00H
OPC051:	DB	'P','U','S','H',00H
OPC052:	DB	'R','A','L',00H
OPC053:	DB	'R','A','R',00H
OPC054:	DB	'R','C',00H
OPC055:	DB	'R','E','T',00H
OPC056:	DB	'R','L','C',00H
OPC057:	DB	'R','M',00H
OPC058:	DB	'R','N','C',00H
OPC059:	DB	'R','N','Z',00H
OPC060:	DB	'R','P',00H
OPC061:	DB	'R','P','E',00H
OPC062:	DB	'R','P','O',00H
OPC063:	DB	'R','R','C',00H
OPC064:	DB	'R','S','T','0',00H
OPC065:	DB	'R','S','T','1',00H
OPC066:	DB	'R','S','T','2',00H
OPC067:	DB	'R','S','T','3',00H
OPC068:	DB	'R','S','T','4',00H
OPC069:	DB	'R','S','T','5',00H
OPC070:	DB	'R','S','T','6',00H
OPC071:	DB	'R','S','T','7',00H
OPC072:	DB	'R','Z',00H
OPC073:	DB	'S','B','B',00H
OPC074:	DB	'S','B','I',00H
OPC075:	DB	'S','H','L','D',00H
OPC076:	DB	'S','P','H','L',00H
OPC077:	DB	'S','T','A',00H
OPC078:	DB	'S','T','A','X',00H
OPC079:	DB	'S','T','C',00H
OPC080:	DB	'S','U','B',00H
OPC081:	DB	'S','U','I',00H
OPC082:	DB	'X','C','H','G',00H
OPC083:	DB	'X','R','A',00H
OPC084:	DB	'X','R','I',00H
OPC085:	DB	'X','T','H','L',00H
;
OPCPTR:
	DW	OPC045,OPC042,OPC078,OPC029,OPC028,OPC022,OPC044,OPC056
	DW	OPC001,OPC021,OPC040,OPC023,OPC028,OPC022,OPC044,OPC063
	DW	OPC001,OPC042,OPC078,OPC029,OPC028,OPC022,OPC044,OPC052
	DW	OPC001,OPC021,OPC040,OPC023,OPC028,OPC022,OPC044,OPC053
	DW	OPC001,OPC042,OPC075,OPC029,OPC028,OPC022,OPC044,OPC020
	DW	OPC001,OPC021,OPC041,OPC023,OPC028,OPC022,OPC044,OPC011
	DW	OPC001,OPC042,OPC077,OPC029,OPC028,OPC022,OPC044,OPC079
	DW	OPC001,OPC021,OPC039,OPC023,OPC028,OPC022,OPC044,OPC012
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC026,OPC043
	DW	OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043,OPC043
	DW	OPC004,OPC004,OPC004,OPC004,OPC004,OPC004,OPC004,OPC004
	DW	OPC003,OPC003,OPC003,OPC003,OPC003,OPC003,OPC003,OPC003
	DW	OPC080,OPC080,OPC080,OPC080,OPC080,OPC080,OPC080,OPC080
	DW	OPC073,OPC073,OPC073,OPC073,OPC073,OPC073,OPC073,OPC073
	DW	OPC006,OPC006,OPC006,OPC006,OPC006,OPC006,OPC006,OPC006
	DW	OPC083,OPC083,OPC083,OPC083,OPC083,OPC083,OPC083,OPC083
	DW	OPC046,OPC046,OPC046,OPC046,OPC046,OPC046,OPC046,OPC046
	DW	OPC013,OPC013,OPC013,OPC013,OPC013,OPC013,OPC013,OPC013
	DW	OPC059,OPC050,OPC034,OPC033,OPC014,OPC051,OPC005,OPC064
	DW	OPC072,OPC055,OPC038,OPC001,OPC019,OPC008,OPC002,OPC065
	DW	OPC058,OPC050,OPC031,OPC048,OPC014,OPC051,OPC081,OPC066
	DW	OPC054,OPC001,OPC030,OPC027,OPC009,OPC001,OPC074,OPC067
	DW	OPC062,OPC050,OPC037,OPC085,OPC018,OPC051,OPC007,OPC068
	DW	OPC061,OPC049,OPC036,OPC082,OPC016,OPC001,OPC084,OPC069
	DW	OPC060,OPC050,OPC035,OPC024,OPC015,OPC051,OPC047,OPC070
	DW	OPC057,OPC076,OPC032,OPC025,OPC010,OPC001,OPC017,OPC071
;
OPR000:	DB	00H,00H
OPR001:	DB	01H,00H
OPR002:	DB	02H,00H
OPR00B:	DB	'B',00H
OPR00C:	DB	'C',00H
OPR00D:	DB	'D',00H
OPR00E:	DB	'E',00H
OPR00H:	DB	'H',00H
OPR00L:	DB	'L',00H
OPR00M:	DB	'M',00H
OPR00A:	DB	'A',00H
OPRPSW:	DB	'P','S','W',00H
OPR0SP:	DB	'S','P',00H
;
OPRPTR1:
	DW	OPR000,OPR00B,OPR00B,OPR00B,OPR00B,OPR00B,OPR00B,OPR000
	DW	OPR000,OPR00B,OPR00B,OPR00B,OPR00C,OPR00C,OPR00C,OPR000
	DW	OPR000,OPR00D,OPR00D,OPR00D,OPR00D,OPR00D,OPR00D,OPR000
	DW	OPR000,OPR00D,OPR00D,OPR00D,OPR00E,OPR00E,OPR00E,OPR000
	DW	OPR000,OPR00H,OPR002,OPR00H,OPR00H,OPR00H,OPR00H,OPR000
	DW	OPR000,OPR00H,OPR002,OPR00H,OPR00L,OPR00L,OPR00L,OPR000
	DW	OPR000,OPR0SP,OPR002,OPR0SP,OPR00M,OPR00M,OPR00M,OPR000
	DW	OPR000,OPR0SP,OPR002,OPR0SP,OPR00A,OPR00A,OPR00A,OPR000
	DW	OPR00B,OPR00B,OPR00B,OPR00B,OPR00B,OPR00B,OPR00B,OPR00B
	DW	OPR00C,OPR00C,OPR00C,OPR00C,OPR00C,OPR00C,OPR00C,OPR00C
	DW	OPR00D,OPR00D,OPR00D,OPR00D,OPR00D,OPR00D,OPR00D,OPR00D
	DW	OPR00E,OPR00E,OPR00E,OPR00E,OPR00E,OPR00E,OPR00E,OPR00E
	DW	OPR00H,OPR00H,OPR00H,OPR00H,OPR00H,OPR00H,OPR00H,OPR00H
	DW	OPR00L,OPR00L,OPR00L,OPR00L,OPR00L,OPR00L,OPR00L,OPR00L
	DW	OPR00M,OPR00M,OPR00M,OPR00M,OPR00M,OPR00M,OPR000,OPR00M
	DW	OPR00A,OPR00A,OPR00A,OPR00A,OPR00A,OPR00A,OPR00A,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR000,OPR00B,OPR002,OPR002,OPR002,OPR00B,OPR001,OPR000
	DW	OPR000,OPR000,OPR002,OPR002,OPR002,OPR002,OPR001,OPR000
	DW	OPR000,OPR00D,OPR002,OPR001,OPR002,OPR00D,OPR001,OPR000
	DW	OPR000,OPR000,OPR002,OPR001,OPR002,OPR002,OPR001,OPR000
	DW	OPR000,OPR00H,OPR002,OPR000,OPR002,OPR00H,OPR001,OPR000
	DW	OPR000,OPR000,OPR002,OPR000,OPR002,OPR002,OPR001,OPR000
	DW	OPR000,OPRPSW,OPR002,OPR000,OPR002,OPRPSW,OPR001,OPR000
	DW	OPR000,OPR000,OPR002,OPR000,OPR002,OPR002,OPR001,OPR000
;
OPRPTR2:
	DW	OPR000,OPR002,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR002,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR002,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR002,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR001,OPR000
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR000,OPR00A
	DW	OPR00B,OPR00C,OPR00D,OPR00E,OPR00H,OPR00L,OPR00M,OPR00A
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
	DW	OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000,OPR000
opecod:
	POP	D
	POP	B
	PUSH	B
	PUSH	D
	LXI	D,OPCPTR
	MVI	H,00H
	MOV	L,C
	DAD	H
	DAD	D
	MOV	E,M
	INX	H
	MOV	D,M
	XCHG
	RET
operd1:
	POP	D
	POP	B
	PUSH	B
	PUSH	D
	LXI	D,OPRPTR1
	MVI	H,00H
	MOV	L,C
	DAD	H
	DAD	D
	MOV	E,M
	INX	H
	MOV	D,M
	XCHG
	RET
operd2:
	POP	D
	POP	B
	PUSH	B
	PUSH	D
	LXI	D,OPRPTR2
	MVI	H,00H
	MOV	L,C
	DAD	H
	DAD	D
	MOV	E,M
	INX	H
	MOV	D,M
	XCHG
	RET
;----- call1.mac   Small-C  arithmetic and logical library
;	
;	part 1		Multiply Routine
;
	;
	;MULTIPLY DE BY HL AND RETURN IN HL
	;(SIGNED MULTIPLY)
	;
CCMULT:
MULT:	MOV	B,H
	MOV	C,L
	LXI	H,0
CCMLT1:	MOV	A,C
	RRC
	JNC	CCMLT2
	DAD	D
CCMLT2:	XRA	A
	MOV	A,B
	RAR
	MOV	B,A
	MOV	A,C
	RAR
	MOV	C,A
	ORA	B
	RZ
	XRA	A
	MOV	A,E
	RAL
	MOV	E,A
	MOV	A,D
	RAL
	MOV	D,A
	ORA	E
	RZ
	JMP	CCMLT1
;
;----- call2.mac   Small-C  arithmetic and logical library
;
;
;	part 2			divide routine
;
	;DIVIDE DE BY HL AND RETURN QUOTIENT IN HL, REMAINDER IN DE
	;(SIGNED DIVIDE)
	;
CCDIV:
DIV:	MOV	B,H
	MOV	C,L
	MOV	A,D
	XRA	B
	PUSH	PSW
	MOV	A,D
	ORA	A
	CM	CCDENEG
	MOV	A,B
	ORA	A
	CM	CCBCNEG
	MVI	A,16
	PUSH	PSW
	XCHG
	LXI	D,0
CCDIV1:	DAD	H
	CALL	CCRDEL
	JZ	CCDIV2
	CALL	CCCMPBCDE
	JM	CCDIV2
	MOV	A,L
	ORI	1
	MOV	L,A
	MOV	A,E
	SUB	C
	MOV	E,A
	MOV	A,D
	SBB	B
	MOV	D,A
CCDIV2:	POP	PSW
	DCR	A
	JZ	CCDIV3
	PUSH	PSW
	JMP	CCDIV1
CCDIV3:	POP	PSW
	RP
	CALL	CCDENEG
	XCHG
	CALL	CCDENEG
	XCHG
	RET
	;
	;NEGATE THE INTEGER IN DE
	;(INTERNAL ROUTINE)
	;
CCDENEG:
	MOV	A,D
	CMA
	MOV	D,A
	MOV	A,E
	CMA
	MOV	E,A
	INX	D
	RET
	;
	;NEGATE THE INTEGER IN BC
	;(INTERNAL ROUTINE)
	;
CCBCNEG:
	MOV	A,B
	CMA
	MOV	B,A
	MOV	A,C
	CMA
	MOV	C,A
	INX	B
	RET
	;
	;ROTATE DE LEFT ONE BIT
	;(INTERNAL ROUTINE)
	;
CCRDEL:
	MOV	A,E
	RAL
	MOV	E,A
	MOV	A,D
	RAL
	MOV	D,A
	ORA	E
	RET
	;
	;COMPARE BC TO DE
	;(INTERNAL ROUTINE)
	;
CCCMPBCDE:
	MOV	A,E
	SUB	C
	MOV	A,D
	SBB	B
	RET
;
;----- call3.mac   Small-C  arithmetic and logical library
;
;	part 3		switch routine
;
	;
	; EXECUTE "SWITCH" STATEMENT
	;
	;  HL  =  SWITCH VALUE
	; (SP) -> SWITCH TABLE
	;         DW ADDR1, VALUE1
	;         DW ADDR2, VALUE2
	;         ...
	;         DW 0
	;        [JMP default]
	;         continuation
	;
CCSWITCH:
	XCHG	;DE =  SWITCH VALUE
	POP	H	;HL -> SWITCH TABLE
SWLOOP:	MOV	C,M
	INX	H
	MOV	B,M	;BC -> CASE ADDR, ELSE 0
	INX	H
	MOV	A,B
	ORA	C
	JZ	SWEND	;DEFAULT OR CONTINUATION CODE
	MOV	A,M
	INX	H
	CMP	E
	MOV	A,M
	INX	H
	JNZ	SWLOOP
	CMP	D
	JNZ	SWLOOP
	MOV	H,B	;CASE MATCHED
	MOV	L,C
SWEND:	PCHL
;
;----- call4.mac   Small-C  arithmetic and logical library
;
;
;		part 4		arithmetic shift routines
;
	;
	;SHIFT DE ARITHMETICALLY RIGHT BY HL AND RETURN IN HL
	;
CCASR:
	XCHG
	DCR	E
	RM
	MOV	A,H
	RAL
	MOV	A,H
	RAR
	MOV	H,A
	MOV	A,L
	RAR
	MOV	L,A
	JMP	CCASR+1
	;
	;SHIFT DE ARITHMETICALLY LEFT BY HL AND RETURN IN HL
	;
CCASL:
	XCHG
	DCR	E
	RM
	DAD	H
	JMP	CCASL+1
	;
;
;----- call5.mac   Small-C  arithmetic and logical library
;
;
;	part 5		main routine - multiply, divide, switch and
;				shift  routines in seperate modules
;
CCDCAL:
	PCHL
CCDDGC:
	DAD	D
	JMP	CCGCHAR
	;
CCDSGC:
	INX	H
	INX	H
	DAD	SP
	;
	;FETCH A SINGLE BYTE FROM THE ADDRESS IN HL AND
	;SIGN EXTEND INTO HL
	;
CCGCHAR:
	MOV	A,M
	;
	;PUT THE ACCUM INTO HL AND SIGN EXTEND THROUGH H.
	;
CCARGC:
CCSXT:
	MOV	L,A
	RLC
	SBB	A
	MOV	H,A
	RET
	;
CCDDGI:
	DAD	D
	JMP	CCGINT
	;
CCDSGI:
	INX	H
	INX	H
	DAD	SP
	;
	;FETCH A FULL 16-BIT INTEGER FROM THE ADDRESS IN HL
	;INTO HL
	;
CCGINT:
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	RET
	;
CCDECC:
	INX	H
	INX	H
 	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGCHAR
	DCX	H
	MOV	A,L
	STAX	D
	RET
	;
CCINCC:
	INX	H
	INX	H
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGCHAR
	INX	H
	MOV	A,L
	STAX	D
	RET
	;
	;
;
CCDDPC:
CDPDPC:
	;
	DAD	D
CCPDPC:
	POP	B	;RET ADDR
	POP	D
	PUSH	B
	;
	;STORE A SINGLE BYTE FROM HL AT THE ADDRESS IN DE
	;
CCPCHAR:
PCHAR:	MOV	A,L
	STAX	D
	RET
	;
CCDECI:
	INX	H
	INX	H
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	DCX	H
	JMP	CCPINT
	;
CCINCI:
	INX	H
	INX	H
	DAD	SP
	MOV	D,H
	MOV	E,L
	CALL	CCGINT
	INX	H
 	JMP	CCPINT
	;
	;
;
CCDDPI:
CDPDPI:
	;
	DAD	D
CCPDPI:
	POP	B	;RET ADDR
	POP	D
	PUSH	B
	;
	;STORE A 16-BIT INTEGER IN HL AT THE ADDRESS IN DE
	;
CCPINT:
PINT:	MOV	A,L
	STAX	D
	INX	D
	MOV	A,H
	STAX	D
	RET
	;
	;INCLUSIVE "OR" HL AND DE INTO HL
	;
CCOR:
	MOV	A,L
	ORA	E
	MOV	L,A
	MOV	A,H
	ORA	D
	MOV	H,A
	RET
	;
	;EXCLUSIVE "OR" HL AND DE INTO HL
	;
CCXOR:
	MOV	A,L
	XRA	E
	MOV	L,A
	MOV	A,H
	XRA	D
	MOV	H,A
	RET
	;
	;"AND" HL AND DE INTO HL
	;
CCAND:
	MOV	A,L
	ANA	E
	MOV	L,A
	MOV	A,H
	ANA	D
	MOV	H,A
	RET
	;
	;IN ALL THE FOLLOWING COMPARE ROUTINES, HL IS SET TO 1 IF THE
	;CONDITION IS TRUE, OTHERWISE IT IS SET TO 0 (ZERO).
	;
	;TEST IF HL = DE
	;
CCEQ:
	CALL	CCCMP
	RZ
	DCX	H
	RET
	;
	;TEST IF DE <> HL
	;
CCNE:
	CALL	CCCMP
	RNZ
	DCX	H
	RET
	;
	;TEST IF DE > HL (SIGNED)
	;
CCGT:
	XCHG
	CALL	CCCMP
	RC
	DCX	H
	RET
	;
	;TEST IF DE <= HL (SIGNED)
	;
CCLE:
	CALL	CCCMP
	RZ
	RC
	DCX	H
	RET
	;
	;TEST IF DE >= HL (SIGNED)
	;
CCGE:
	CALL	CCCMP
	RNC
	DCX	H
	RET
	;
	;TEST IF DE < HL (SIGNED)
	;
CCLT:
	CALL	CCCMP
	RC
	DCX	H
	RET
	;
	;COMMON ROUTINE TO PERFORM A SIGNED COMPARE
	; OF DE AND HL
	;THIS ROUTINE PERFORMS DE - HL AND SETS THE CONDITIONS: 
	; CARRY REFLECTS SIGN OF DIFFERENCE (SET MEANS DE < HL)
	; ZERO/NON-ZERO SET ACCORDING TO EQUALITY.
	;
CCCMP:
	MOV	A,H	;INVERT SIGN OF HL
	XRI	80H
	MOV	H,A
	MOV	A,D	;INVERT SIGN OF DE
	XRI	80H
	CMP	H	;COMPARE MSBS
	JNZ	CCCMP1	;DONE IF NEQ
	MOV	A,E	;COMPARE LSBS
	CMP	L
CCCMP1:	LXI	H,1	;PRESET TRUE COND
	RET
	;
	;TEST IF DE >= HL (UNSIGNED)
	;
CCUGE:
	CALL	CCUCMP
	RNC
	DCX	H
	RET
	;
	;TEST IF DE < HL (UNSIGNED)
	;
CCULT:
	CALL	CCUCMP
	RC
	DCX	H
	RET
	;
	;TEST IF DE > HL (UNSIGNED)
	;
CCUGT:
	XCHG
	CALL	CCUCMP
	RC
	DCX	H
	RET
	;
	;TEST IF DE <= HL (UNSIGNED)
	;
CCULE:
	CALL	CCUCMP
	RZ
	RC
	DCX	H
	RET
	;
	;COMMON ROUTINE TO PERFORM UNSIGNED COMPARE
	;CARRY SET IF DE < HL
	;ZERO/NONZERO SET ACCORDINGLY
	;
CCUCMP:
	MOV	A,D
	CMP	H
	JNZ	CCUCP1
	MOV	A,E
	CMP	L
CCUCP1:	LXI	H,1
	RET
	;
	;SUBTRACT HL FROM DE AND RETURN IN HL
	;
CCSUB:
	MOV	A,E
	SUB	L
	MOV	L,A
	MOV	A,D
	SBB	H
	MOV	H,A
	RET
	;
	;FORM THE TWO'S COMPLEMENT OF HL
	;
CCNEG:
	CALL	CCCOM
	INX	H
	RET
	;
	;FORM THE ONE'S COMPLEMENT OF HL
	;
CCCOM:
	MOV	A,H
	CMA
	MOV	H,A
	MOV	A,L
	CMA
	MOV	L,A
	RET
CCLNEG:
	MOV	A,H
	ORA	L
	JNZ	$+6
	MVI	L,1
	RET
	LXI	H,0
	RET
;
	ORG	LTOP
;
OBTM:	DS	0002H
CLABL:	DS	0002H
RSTCK:	DS	0002H
NCNTR:	DS	0002H
FCNTR:	DS	0002H
FSTPV:	DS	0002H
FTOV:	DS	0002H
FLABL:	DS	0002H
FOBJ:	DS	0002H
RWRK:	DS	0002H
OTOP	EQU	$
;
;	SYSTEM PARAMETERS
	ORG	STACK
RBFCNT	DS	01H
RBFRDP	DS	01H
RBFWTP	DS	01H
XFLAGS	DS	01H
RECBUF	DS	100H
;
	END
